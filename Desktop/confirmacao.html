<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Frete - Correios</title>
</head>
<body>
    <h1>Calculadora de Frete - Correios</h1>
    
    <form id="freteForm">
        <label for="cepOrigem">CEP de Origem:</label>
        <input type="text" id="cepOrigem" name="cepOrigem" placeholder="Digite o CEP de origem" required><br><br>

        <label for="cepDestino">CEP de Destino:</label>
        <input type="text" id="cepDestino" name="cepDestino" placeholder="Digite o CEP de destino" required><br><br>

        <label for="peso">Peso (em kg):</label>
        <input type="number" step="0.01" id="peso" name="peso" placeholder="Peso do pacote" required><br><br>

        <button type="submit">Calcular Frete</button>
    </form>

    <p id="resultado"></p>

    <script src="script.js"></script>
    <script>
        document.getElementById("freteForm").addEventListener("submit", function(event) {
            event.preventDefault(); // Impede o envio do formulário
        
            // Capturar os valores inseridos no formulário
            const cepOrigem = document.getElementById("cepOrigem").value;
            const cepDestino = document.getElementById("cepDestino").value;
            const peso = document.getElementById("peso").value;
        
            // Configurar os parâmetros da requisição
            const url = `http://ws.correios.com.br/calculador/CalcPrecoPrazo.aspx?` +
                        `nCdEmpresa=&sDsSenha=&nCdServico=04014&` + // 04014 = SEDEX sem contrato
                        `sCepOrigem=${cepOrigem}&sCepDestino=${cepDestino}&nVlPeso=${peso}&` +
                        `nCdFormato=1&nVlComprimento=20&nVlAltura=10&nVlLargura=15&` +
                        `nVlDiametro=0&sCdMaoPropria=N&nVlValorDeclarado=0&sCdAvisoRecebimento=N&` +
                        `StrRetorno=xml&nIndicaCalculo=3`;
        
            // Fazer a requisição à API dos Correios
            fetch(url)
                .then(response => response.text())
                .then(data => {
                    // Converter a resposta XML para JSON (ou trabalhar diretamente com o XML)
                    const parser = new DOMParser();
                    const xmlDoc = parser.parseFromString(data, "text/xml");
        
                    // Pegar o valor do frete e o prazo de entrega
                    const valor = xmlDoc.getElementsByTagName("Valor")[0].textContent;
                    const prazoEntrega = xmlDoc.getElementsByTagName("PrazoEntrega")[0].textContent;
        
                    // Exibir o resultado
                    document.getElementById("resultado").innerText = `Valor do frete: R$ ${valor} \nPrazo de entrega: ${prazoEntrega} dias úteis.`;
                })
                .catch(error => {
                    console.error("Erro ao calcular o frete:", error);
                    document.getElementById("resultado").innerText = "Erro ao calcular o frete.";
                });
        });
        
    </script>
</body>
</html>
